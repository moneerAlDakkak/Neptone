(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-26ececcb"],{"293a":function(e,t,r){"use strict";r.r(t);var n=r("7a23"),s={class:"page chat-page"},c={id:"outputScreen"},i={class:"privacy-note"};function o(e,t,r,o,a,u){var p=Object(n["z"])("w-message"),l=Object(n["z"])("w-input"),f=Object(n["z"])("w-popup");return Object(n["r"])(),Object(n["e"])("div",s,[Object(n["i"])("div",c,[Object(n["i"])("p",i,Object(n["C"])(u.appVocubulary.privacyNote),1),(Object(n["r"])(!0),Object(n["e"])(n["a"],null,Object(n["x"])(a.messages,(function(e){return Object(n["r"])(),Object(n["e"])(p,{key:e.text,replyText:e.replyText,byWho:e.byWho,text:e.text,onSetReplytext:u.setReplyText},null,8,["replyText","byWho","text","onSetReplytext"])})),128))]),Object(n["i"])(l,{onSendContent:t[3]||(t[3]=function(e){return u.sendMessage()}),reply:a.replyText,onNoReply:t[4]||(t[4]=function(e){return a.replyText=""})},{default:Object(n["K"])((function(){return[Object(n["L"])(Object(n["i"])("textarea",{id:"chat-textarea","onUpdate:modelValue":t[1]||(t[1]=function(e){return a.typedMessage=e}),onInput:t[2]||(t[2]=function(e){return u.adjustDirection(e)})},null,544),[[n["H"],a.typedMessage]])]})),_:1},8,["reply"]),Object(n["i"])(n["b"],{name:"opacity"},{default:Object(n["K"])((function(){return[Object(n["i"])(f,{ref:"popup"},null,512)]})),_:1})])}var a=r("1da1"),u=(r("96cf"),r("498a"),r("b0c0"),r("99af"),r("c0ea")),p=r("ea38"),l=Object(n["N"])("data-v-70c04f13");Object(n["u"])("data-v-70c04f13");var f={key:0,class:"reply"};Object(n["s"])();var h=l((function(e,t,r,s,c,i){var o=Object(n["z"])("w-d-text");return Object(n["r"])(),Object(n["e"])("div",{class:c.byMe?"by-me":""},[Object(n["i"])("div",{class:"message ".concat(c.hasReply?"has-reply":""),onClick:t[1]||(t[1]=function(e){return i.replyToThis()})},[Object(n["L"])(Object(n["i"])("span",{class:"username"},Object(n["C"])(r.byWho),513),[[n["I"],c.usernameShow]]),Object(n["i"])(o,{text:r.text},null,8,["text"]),r.replyText?(Object(n["r"])(),Object(n["e"])("span",f,Object(n["C"])(r.replyText),1)):Object(n["f"])("",!0)],2)],2)})),d=r("7a3d"),m={name:"WMessage",components:{WDText:d["a"]},props:["text","replyText","byWho"],data:function(){return{usernameShow:!1,byMe:!1,hasReply:!1}},beforeMount:function(){"me"===this.byWho&&(this.byMe=!0),"me"!==this.byWho&&""!==this.room_name&&(this.usernameShow=!0),this.replyText&&""!==this.replyText&&(this.hasReply=!0)},methods:{replyToThis:function(){this.$emit("set-replytext",this.text)}}};r("4d80");m.render=h,m.__scopeId="data-v-70c04f13";var b=m,y={name:"Chat",data:function(){return{typedMessage:"",replyText:"",resolvePromise:"",rejectPromise:"",messages:[]}},components:{WPopup:p["a"],WInput:u["a"],WMessage:b},computed:{socket:function(){return this.$store.state.socket},thisUser:function(){return this.$store.state.user},thePartner:function(){return this.$store.state.partner},lang:function(){return this.$store.state.lang},appVocubulary:function(){return this.$store.state.appVocubulary[this.lang].pages.Chat}},methods:{sendMessage:function(){""!==this.typedMessage.trim()&&(this.socket.emit("messageFromClient",{id:this.thisUser._id,name:this.thisUser.name,room:this.thisUser.room,text:this.typedMessage,replyText:this.replyText}),this.messages.push({text:this.typedMessage,byWho:"me",replyText:this.replyText}),this.typedMessage="",this.replyText="",document.getElementById("outputScreen").scrollBy(0,document.getElementById("outputScreen").scrollHeight+800),document.querySelector("textarea").focus())},setReplyText:function(e){this.replyText=e},adjustDirection:function(e){var t=/[\u0621-\u064A]/;t.test(e.currentTarget.value[0])?e.currentTarget.dir="rtl":e.currentTarget.dir="ltr"},showPopup:function(e,t){var r=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,r.$refs.popup.show(e);case 2:s=n.sent,s?t():t(!1);case 4:case"end":return n.stop()}}),n)})))()}},beforeMount:function(){(""!==this.thisUser.room_name&&""===this.thisUser.room||this.thisUser.name===this.thePartner.name)&&document.getElementById("home-link").click()},mounted:function(){var e=this;this.socket.on("messageFromServer",(function(t){e.messages.push({text:t.text,byWho:t.name,replyText:t.replyText})})),this.socket.on("removePartner",(function(t){e.thePartner.socketId===t&&(e.partnerLeft=!0,document.getElementById("home-link").click())}))},beforeRouteLeave:function(e,t,r){this.partnerLeft?this.showPopup({message:"".concat(this.thePartner.name," ").concat(this.appVocubulary.userLeft),confirmText:"OK"},r):this.showPopup({message:this.appVocubulary.confirmLeave,confirmText:"OK",cancelText:"CANCEL"},r)},beforeUnmount:function(){this.socket.emit("leaveRoom",{roomId:this.thisUser.room,isPartner:!0})},unmounted:function(){this.socket.removeAllListeners("messageFromServer"),this.socket.removeAllListeners("removePartner")}};r("d4e5");y.render=o;t["default"]=y},3730:function(e,t,r){},"498a":function(e,t,r){"use strict";var n=r("23e7"),s=r("58a8").trim,c=r("c8d2");n({target:"String",proto:!0,forced:c("trim")},{trim:function(){return s(this)}})},"4d80":function(e,t,r){"use strict";r("6400")},"52db":function(e,t,r){"use strict";r("5de4")},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,r){var n=r("1d80"),s=r("5899"),c="["+s+"]",i=RegExp("^"+c+c+"*"),o=RegExp(c+c+"*$"),a=function(e){return function(t){var r=String(n(t));return 1&e&&(r=r.replace(i,"")),2&e&&(r=r.replace(o,"")),r}};e.exports={start:a(1),end:a(2),trim:a(3)}},"5de4":function(e,t,r){},6400:function(e,t,r){},"7a3d":function(e,t,r){"use strict";var n=r("7a23"),s=Object(n["N"])("data-v-372ff306"),c=s((function(e,t,r,s,c,i){return Object(n["r"])(),Object(n["e"])("p",{dir:c.direction},Object(n["C"])(r.text),9,["dir"])})),i={name:"WDText",props:["text"],data:function(){return{en:/[a-zA-Z0-9]/,ar:/[\u0621-\u064A]/,direction:"ltr"}},mounted:function(){this.ar.test(this.text[0])?this.direction="rtl":this.direction="ltr"}};r("e59c");i.render=c,i.__scopeId="data-v-372ff306";t["a"]=i},"99af":function(e,t,r){"use strict";var n=r("23e7"),s=r("d039"),c=r("e8b5"),i=r("861d"),o=r("7b0b"),a=r("50c4"),u=r("8418"),p=r("65f0"),l=r("1dde"),f=r("b622"),h=r("2d00"),d=f("isConcatSpreadable"),m=9007199254740991,b="Maximum allowed index exceeded",y=h>=51||!s((function(){var e=[];return e[d]=!1,e.concat()[0]!==e})),x=l("concat"),j=function(e){if(!i(e))return!1;var t=e[d];return void 0!==t?!!t:c(e)},O=!y||!x;n({target:"Array",proto:!0,forced:O},{concat:function(e){var t,r,n,s,c,i=o(this),l=p(i,0),f=0;for(t=-1,n=arguments.length;t<n;t++)if(c=-1===t?i:arguments[t],j(c)){if(s=a(c.length),f+s>m)throw TypeError(b);for(r=0;r<s;r++,f++)r in c&&u(l,f,c[r])}else{if(f>=m)throw TypeError(b);u(l,f++,c)}return l.length=f,l}})},c0ea:function(e,t,r){"use strict";var n=r("7a23"),s={class:"w-input"},c={class:"main-sender"},i=Object(n["i"])("i",{class:"fas fa-angle-right fa-2x"},null,-1),o={key:0,class:"replying-guide"},a=Object(n["i"])("i",{class:"fas fa-times"},null,-1);function u(e,t,r,u,p,l){var f=this;return Object(n["r"])(),Object(n["e"])("div",s,[Object(n["i"])("div",c,[Object(n["y"])(e.$slots,"default"),Object(n["i"])("button",{onClick:t[1]||(t[1]=function(e){return f.$emit("send-content")})},[i])]),Object(n["i"])(n["b"],{name:"from-bottom"},{default:Object(n["K"])((function(){return[r.reply?(Object(n["r"])(),Object(n["e"])("div",o,[Object(n["i"])("button",{onClick:t[2]||(t[2]=function(t){return e.$emit("no-reply")})},[a]),Object(n["i"])("span",null,Object(n["C"])(r.reply),1)])):Object(n["f"])("",!0)]})),_:1})])}var p={name:"WInput",props:["reply"]};r("52db");p.render=u;t["a"]=p},c342:function(e,t,r){},c8d2:function(e,t,r){var n=r("d039"),s=r("5899"),c="​᠎";e.exports=function(e){return n((function(){return!!s[e]()||c[e]()!=c||s[e].name!==e}))}},d4e5:function(e,t,r){"use strict";r("c342")},e59c:function(e,t,r){"use strict";r("3730")}}]);
//# sourceMappingURL=chunk-26ececcb.03aa9902.js.map